*
**************************************************************************
*Copyright (c) 2006 Zumasys, Inc. as an unpublished work. All rights     *
*reserved. You are free to use this code within your own applications,   *
*but you are expressly forbidden from selling or otherwise distributing  *
*this code without prior written consent. Portions based on original     *
*design by Joe Goldthwaite.                                              *
**************************************************************************
*
* MODULE: SUI.TEST.KEYBOARD
* AUTHOR: PJS
* VERSION: 1.0.2
* CREATED: 06/01/2004
* UPDATED: 11/08/2006
*
* MAINTENANCE RECORD:
*
* 1.0.2
*  PJS 11/08/2006
*   Added ON (ONWare MVON) platform support.
*
* 1.0.1
*  PJS 07/24/2006
*   Added OI (OpenInsight CTO) platform support.
*
**************************************************************************
**************************************************************************
*
* Smart User Interface test program to check keyboard functions
*
**************************************************************************
**************************************************************************
*
EQU VM TO CHAR(253)
EQU ESC TO CHAR(27), STX TO CHAR(2)
*
NO.PAGE=@(0,0)
$INCLUDE SUI.TERMDEF
*
EQU TERM.KEY.NBRS TO '123456789101112131516171819202122232425262728316162636465666768697071727374757681828384858687888990919293949596151152153154155156';*#DEFAULT#*
EQU TERM.KEY.STRS TO 'ENTERBKSPUPDOWNLEFTRIGHTPGUPPGDNHOMEENDINSDELTABESCAPESENTERSBKSPSUPSDOWNSLEFTSRIGHTSPGUPSPGDNSHOMESENDSINSSDELSTABATTF1F2F3F4F5F6F7F8F9F10F11F12F13F14F15F16SF1SF2SF3SF4SF5SF6SF7SF8SF9SF10SF11SF12SF13SF14SF15SF16LEFTBUTTONRIGHTBUTTONMIDBUTTONDBLLEFTBUTTONDBLRIGHTBUTTONDBLMIDBUTTON';*#DEFAULT#*
*#OI#*EQU TERM.KEY.NBRS TO '123456789101112131516171819202122232425262728316162636465666768697071727374757681828384858687888990919293949596151152153154155156'
*#OI#*TERM.KEY.STRS = 'ENTERBKSPUPDOWNLEFTRIGHTPGUPPGDNHOMEENDINSDELTABESCAPESENTERSBKSPSUPSDOWNSLEFTSRIGHTSPGUPSPGDNSHOMESENDSINSSDELSTABATT'
*#OI#*TERM.KEY.STRS = TERM.KEY.STRS : 'F1F2F3F4F5F6F7F8F9F10F11F12F13F14F15F16SF1SF2SF3SF4SF5SF6SF7SF8SF9SF10SF11SF12SF13SF14SF15SF16'
*#OI#*TERM.KEY.STRS = TERM.KEY.STRS : 'LEFTBUTTONRIGHTBUTTONMIDBUTTONDBLLEFTBUTTONDBLRIGHTBUTTONDBLMIDBUTTON'
*#ON#*TERM.KEY.NBRS = '1]2]3]4]5]6]7]8]9]10]11]12]13]15]16]17]18]19]20]21]22]23]24]25]26]27]28]31]61]62]63]64]65]66]67]68]69]70]71]72]73]74]75]76]81]82]83]84]85]86]87]88]89]90]91]92]93]94]95]96]151]152]153]154]155]156'
*#ON#*CONVERT ']' TO VM IN TERM.KEY.NBRS
*#ON#*TERM.KEY.STRS = 'ENTER]BKSP]UP]DOWN]LEFT]RIGHT]PGUP]PGDN]HOME]END]INS]DEL]TAB]ESCAPE]SENTER]SBKSP]SUP]SDOWN]SLEFT]SRIGHT]SPGUP]SPGDN]SHOME]SEND]SINS]SDEL]STAB]ATT]F1]F2]F3]F4]F5]F6]F7]F8]F9]F10]F11]F12]F13]F14]F15]F16]SF1]SF2]SF3]SF4]SF5]SF6]SF7]SF8]SF9]SF10]SF11]SF12]SF13]SF14]SF15]SF16]LEFTBUTTON]RIGHTBUTTON]MIDBUTTON]DBLLEFTBUTTON]DBLRIGHTBUTTON]DBLMIDBUTTON'
*#ON#*CONVERT ']' TO VM IN TERM.KEY.STRS
*#MVON#*TERM.KEY.NBRS = '1]2]3]4]5]6]7]8]9]10]11]12]13]15]16]17]18]19]20]21]22]23]24]25]26]27]28]31]61]62]63]64]65]66]67]68]69]70]71]72]73]74]75]76]81]82]83]84]85]86]87]88]89]90]91]92]93]94]95]96]151]152]153]154]155]156'
*#MVON#*CONVERT ']' TO VM IN TERM.KEY.NBRS
*#MVON#*TERM.KEY.STRS = 'ENTER]BKSP]UP]DOWN]LEFT]RIGHT]PGUP]PGDN]HOME]END]INS]DEL]TAB]ESCAPE]SENTER]SBKSP]SUP]SDOWN]SLEFT]SRIGHT]SPGUP]SPGDN]SHOME]SEND]SINS]SDEL]STAB]ATT]F1]F2]F3]F4]F5]F6]F7]F8]F9]F10]F11]F12]F13]F14]F15]F16]SF1]SF2]SF3]SF4]SF5]SF6]SF7]SF8]SF9]SF10]SF11]SF12]SF13]SF14]SF15]SF16]LEFTBUTTON]RIGHTBUTTON]MIDBUTTON]DBLLEFTBUTTON]DBLRIGHTBUTTON]DBLMIDBUTTON'
*#MVON#*CONVERT ']' TO VM IN TERM.KEY.STRS
*
CALL SUI.GET.TERM(MAT TermDef)
*
* Keyboard test
*
PRINT TERM.RESET:
PRINT TERM.CLEAR:
PRINT 'Keyboard test for terminal ':TERM.DESC:SPACE(8):
IF TERM.SPECIAL NE '' THEN PRINT '(AccuTerm detected)' ELSE PRINT '(not running AccuTerm)'
PRINT
PRINT 'Press any key click mouse and note the response. Press X to end test.'
PRINT
ECHO OFF; PROMPT ''
IF TERM.SPECIAL NE '' THEN PRINT ESC:STX:'1': ;* AccuTerm mouse on
LOOP
 CALL SUI.INPUT.CHAR(Chr, RtnCom, MAT TermDef)
UNTIL Chr = 'X' OR Chr = 'x' DO
 IF RtnCom THEN
  LOCATE(RtnCom, TERM.KEY.NBRS, 1; P) THEN
   PRINT 'Cmd=':TERM.KEY.STRS<1,P>
  END ELSE
   PRINT 'Cmd=':RtnCom:' (unknown)'
  END
 END ELSE
  PRINT 'Chr=':Chr
 END
REPEAT
ECHO ON; PROMPT '?'
IF TERM.SPECIAL NE '' THEN PRINT ESC:STX:'0': ;* AccuTerm mouse off
*
PRINT TERM.CLEAR:
*
STOP
END